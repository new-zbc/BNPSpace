getwd()
source("demo/dataSim.R")
source("demo/dataSim.R")
source("demo/dataSim.R")
sce
source("demo/model.R")
ARI_value
result$gamma
sessionInfo()
rm(list=ls())
source("reproduce/Figure1.R")
source("reproduce/scripts/figure1.R")
source("reproduce/scripts/figure2.R")
source("reproduce/scripts/figure2.R")
source("reproduce/scripts/figure3.R")
source("reproduce/scripts/figure4.R")
source("reproduce/scripts/figure5A.R")
source("reproduce/scripts/figure5A.R")
cluster
source("reproduce/scripts/figure5A.R")
ggsave(cluster, filename = "reproduce/figures_and_tables/figure5A.png", width = 12, height = 8)
ggsave(cluster, filename = "reproduce/figures_and_tables/figure5A.png", width = 20, height = 10)
help("ggsave")
ggsave(cluster, filename = "reproduce/figures_and_tables/figure5A.png", width = 20, height = 10, bg = "white")
ggsave(cluster, filename = "reproduce/figures_and_tables/figure5A.png", width = 22, height = 10, bg = "white")
source("reproduce/scripts/figure5B.R")
source("reproduce/scripts/figure5B.R")
source("reproduce/scripts/figure5B.R")
source("reproduce/scripts/figure5B.R")
source("reproduce/scripts/figure5C.R")
rm(list=ls())
source("reproduce/scripts/figure5C.R")
source("reproduce/scripts/figure5C.R")
source("reproduce/scripts/figure5D.R")
rm(list=ls())
data_folder = data_folder = "application/DLPFCdata"
file_name = paste0(data_folder, "/", sampleID, "_counts.RData")
load(file_name)
sampleID = 151509
data_folder = "application/DLPFCdata"
file_name = paste0(data_folder, "/", sampleID, "_counts.RData")
load(file_name)
load(paste0(data_folder, "/", "BNPSpace_results.RData"))
rm(list=ls())
source("reproduce/scripts/figureS10.R")
source("reproduce/scripts/figureS10.R")
rm(list=ls())
source("reproduce/scripts/figure5E.R")
rm(list=ls())
folders = c("simulation1/scenario1_1", "simulation1/scenario1_2", "simulation1/scenario1_3",
"simulation1/scenario1_4", "simulation1/scenario1_5", "simulation1/scenario1_6",
"simulation1/scenario1_7", "simulation1/scenario1_8", "simulation1/scenario1_9")
folder = "simulation1/scenario1_1"
file = paste0(folder, "/feature_selection_results.csv")
data = read.csv(file = file)
getwd()
file = paste0(folder, "/feature_selection_result.csv")
data = read.csv(file = file)
View(data)
file = paste0(folder, "/feature_selection_result.csv")
data = read.csv(file = file, row.names = 1)
View(data)
result_mean = matrix(0, length(folders), 4)
result_sd = matrix(0, length(folders), 4)
for(i in 1:length(folders)){
folder = folders[i]
file = paste0(folder, "/feature_selection_result.csv")
data = read.csv(file = file, row.names = 1)
result_mean[i, ] = colMeans(data, na.rm = T)
result_sd[i, ] = apply(data, 2, sd, na.rm = T)
}
folders = c("simulation1/scenario1_1", "simulation1/scenario1_2", "simulation1/scenario1_3",
"simulation1/scenario2_1", "simulation1/scenario2_2", "simulation1/scenario2_3",
"simulation1/scenario3_1", "simulation1/scenario3_2", "simulation1/scenario3_3")
result_mean = matrix(0, length(folders), 4)
result_sd = matrix(0, length(folders), 4)
for(i in 1:length(folders)){
folder = folders[i]
file = paste0(folder, "/feature_selection_result.csv")
data = read.csv(file = file, row.names = 1)
result_mean[i, ] = colMeans(data, na.rm = T)
result_sd[i, ] = apply(data, 2, sd, na.rm = T)
}
View(result_mean)
res = data.frame(pi = rep(c(0.1, 0.2, 0.3), 3), K = rep(c(3, 5, 7), each = 3))
View(res)
res_mean = as.data.frame(cbind(res, result_mean))
res_sd = as.data.frame(cbind(res, result_sd))
View(res_mean)
write.csv(res_mean, file = "reproduce/figures_and_tables/table1mean.csv")
colnames(res_mean) = c("pi", "K", "Sensitivity", "Specificity", "MCC", "AUC")
colnames(res_sd) = c("pi", "K", "Sensitivity", "Specificity", "MCC", "AUC")
write.csv(res_mean, file = "reproduce/figures_and_tables/table1mean.csv")
write.csv(res_sd, file = "reproduce/figures_and_tables/table1sd.csv")
rm(list=ls())
source("reproduce/scripts/tableS1.R")
source("reproduce/scripts/tableS1.R")
rm(list=ls())
load("D:/OneDrive - The Chinese University of Hong Kong/Project/BNPSpace/github/BNPSpace/application/MOBdata/result_sce.RData")
sce2
rm(list=ls())
load("application/MOBdata/MCMCresults.RData")
plot_PPI = function(result){
gamma_est = rowMeans(result$MCMCList$gamma_iter)
gamma_est = gamma_est[order(gamma_est, decreasing = T)]
df = data.frame(gene = rep(1:length(gamma_est)), PPI = gamma_est)
library(ggplot2)
p <- ggplot() + geom_point(aes(x = gene, y = PPI), data = df) +
geom_hline(aes(yintercept = 0.5), color = "blue", linetype = "dashed")+
#geom_point(data = df[1:20,], aes(x = gene, y = PPI, color = "red")) +
theme_bw() + xlab("Gene index") + ylab("PPI")+
theme(panel.grid = element_blank(),
axis.title = element_text(size = 10,face = "bold"),
legend.title = element_text(size = 10,face = "bold"),
axis.text = element_text(size = 8, face = "bold"))
p
}
load("application/MOBdata/MCMCresults.RData")
p5 = plot_PPI(result1)
p5
load("application/MOBdata/BIC_result.RData")
data_mDIC = data.frame(f = c(0, 0.5, 1, 1.5, 2, 2.5), mDIC = BIC_result[1:6])
p4 = ggplot(data_mDIC, aes(x = f, y = mDIC)) +
geom_line()+geom_point() + theme_bw() + ylab("pBIC") +
theme(panel.grid = element_blank(),
axis.title = element_text(size = 10,face = "bold"),
legend.title = element_text(size = 10,face = "bold"),
axis.text = element_text(size = 8, face = "bold"))
p = cowplot::plot_grid(p4, p5, ncol = 2, labels = c("a", "b"), rel_widths = c(1.1, 1) )
ggsave(p, filename = "reproduce/figures_and_tables/figureS3.png", width = 6.3, height = 3, units = "in")
rm(list=ls())
source("reproduce/scripts/figureS3.R")
rm(list=ls())
load("D:/OneDrive - The Chinese University of Hong Kong/Project/BNPSpace/github/BNPSpace/application/MOBdata/result_sce.RData")
sce2
rowData(sce2)$gamma
plot_PPI = function(result){
gamma_est = rowData(result)$gamma
gamma_est = gamma_est[order(gamma_est, decreasing = T)]
df = data.frame(gene = rep(1:length(gamma_est)), PPI = gamma_est)
library(ggplot2)
p <- ggplot() + geom_point(aes(x = gene, y = PPI), data = df) +
geom_hline(aes(yintercept = 0.5), color = "blue", linetype = "dashed")+
#geom_point(data = df[1:20,], aes(x = gene, y = PPI, color = "red")) +
theme_bw() + xlab("Gene index") + ylab("PPI")+
theme(panel.grid = element_blank(),
axis.title = element_text(size = 10,face = "bold"),
legend.title = element_text(size = 10,face = "bold"),
axis.text = element_text(size = 8, face = "bold"))
p
}
load("application/MOBdata/result_sce.RData")
p5 = plot_PPI(sce2)
load("application/MOBdata/BIC_result.RData")
data_mDIC = data.frame(f = c(0, 0.5, 1, 1.5, 2, 2.5), mDIC = BIC_result[1:6])
p4 = ggplot(data_mDIC, aes(x = f, y = mDIC)) +
geom_line()+geom_point() + theme_bw() + ylab("pBIC") +
theme(panel.grid = element_blank(),
axis.title = element_text(size = 10,face = "bold"),
legend.title = element_text(size = 10,face = "bold"),
axis.text = element_text(size = 8, face = "bold"))
p = cowplot::plot_grid(p4, p5, ncol = 2, labels = c("a", "b"), rel_widths = c(1.1, 1) )
ggsave(p, filename = "reproduce/figures_and_tables/figureS3.png", width = 6.3, height = 3, units = "in")
rm(list=ls())
